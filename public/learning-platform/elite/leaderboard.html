<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>ë¦¬ë”ë³´ë“œ â€” ì½”ë”©ì™ Elite</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <script>tailwind.config = { darkMode: "class", theme: { extend: { colors: { primary: "#2563eb", "primary-dark": "#1d4ed8", "text-main": "#1e293b", "text-muted": "#64748b", "bg-off": "#f8fafc", "bg-dark": "#0f172a", "surface-dark": "#1e293b", "border-light": "#e2e8f0", "border-dark": "#334155" }, fontFamily: { sans: ["Inter", "sans-serif"] }, boxShadow: { soft: "0 4px 20px -2px rgba(37,99,235,0.15)", card: "0 2px 10px rgba(0,0,0,0.03)" } } } }</script>
    <style>
        .nav-item.active {
            background: rgba(37, 99, 235, .1);
            color: #2563eb;
            border-color: #2563eb
        }

        .dark .nav-item.active {
            background: rgba(37, 99, 235, .2);
            color: #93c5fd
        }

        .tab-btn.active {
            background: #2563eb;
            color: #fff
        }

        .tab-btn {
            background: transparent;
            color: #64748b
        }
    </style>
</head>

<body class="bg-bg-off dark:bg-bg-dark text-text-main dark:text-gray-100 font-sans antialiased min-h-screen">
    <!-- ê³µí†µ ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav
        class="sticky top-0 z-50 bg-white/90 dark:bg-surface-dark/90 backdrop-blur-md border-b border-border-light dark:border-border-dark">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 flex items-center justify-between h-14">
            <div class="flex items-center gap-3">
                <div
                    class="w-8 h-8 rounded-lg bg-primary flex items-center justify-center text-white shadow-md shadow-primary/30">
                    <span class="material-symbols-outlined text-lg">school</span>
                </div><span class="text-sm font-bold text-slate-900 dark:text-white">ì½”ë”©ì™ <span
                        class="text-primary">Elite</span></span>
            </div>
            <div class="hidden md:flex items-center gap-1">
                <a href="roadmap.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ—ºï¸
                    ë¡œë“œë§µ</a>
                <a href="hub.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ“š
                    í—ˆë¸Œ</a>
                <a href="challenge.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ¯
                    ì±Œë¦°ì§€</a>
                <a href="leaderboard.html"
                    class="nav-item active flex items-center gap-1.5 px-3 py-1.5 text-xs font-bold rounded-lg border-b-2 transition-all">ğŸ†
                    ë¦¬ë”ë³´ë“œ</a>
                <a href="goals.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ¯
                    ëª©í‘œ</a>
                <a href="profile.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ‘¤
                    í”„ë¡œí•„</a>
                <a href="editor.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ’»
                    ì—ë””í„°</a>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="toggleDark()"
                    class="w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"><span
                        class="material-symbols-outlined text-lg dark-icon">dark_mode</span><span
                        class="material-symbols-outlined text-lg light-icon hidden">light_mode</span></button>
                <button onclick="document.getElementById('mmenu').classList.toggle('hidden')"
                    class="md:hidden w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-800 flex items-center justify-center"><span
                        class="material-symbols-outlined text-lg text-gray-500">menu</span></button>
            </div>
        </div>
        <div id="mmenu"
            class="hidden md:hidden border-t border-border-light dark:border-border-dark bg-white dark:bg-surface-dark px-4 py-2 space-y-1">
            <a href="roadmap.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ—ºï¸ ë¡œë“œë§µ</a><a
                href="hub.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ“š í—ˆë¸Œ</a><a
                href="challenge.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ¯ ì±Œë¦°ì§€</a>
            <a href="leaderboard.html"
                class="block px-3 py-2 text-sm font-bold text-primary bg-primary/10 rounded-lg">ğŸ† ë¦¬ë”ë³´ë“œ</a>
            <a href="goals.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ¯ ëª©í‘œ</a><a
                href="profile.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ‘¤ í”„ë¡œí•„</a><a
                href="editor.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ’» ì—ë””í„°</a>
        </div>
    </nav>

    <main class="max-w-4xl mx-auto px-4 sm:px-6 py-8 space-y-8">
        <!-- í—¤ë” -->
        <div class="text-center">
            <h1 class="text-2xl sm:text-3xl font-black text-slate-900 dark:text-white mb-2">ğŸ† ì£¼ê°„ ë¦¬ë”ë³´ë“œ</h1>
            <p class="text-sm text-text-muted dark:text-gray-400">ì´ë²ˆ ì£¼ ê°€ì¥ ì—´ì‹¬íˆ í•™ìŠµí•œ í•™ìƒì€?</p>
            <div class="flex justify-center gap-2 mt-4">
                <button class="tab-btn active px-4 py-1.5 rounded-full text-xs font-bold transition-all"
                    onclick="setTab(this,'weekly')">ì£¼ê°„</button>
                <button
                    class="tab-btn px-4 py-1.5 rounded-full text-xs font-bold border border-gray-200 dark:border-gray-700 transition-all"
                    onclick="setTab(this,'monthly')">ì›”ê°„</button>
                <button
                    class="tab-btn px-4 py-1.5 rounded-full text-xs font-bold border border-gray-200 dark:border-gray-700 transition-all"
                    onclick="setTab(this,'all')">ì „ì²´</button>
            </div>
        </div>

        <!-- í¬ë””ì—„ -->
        <div class="flex items-end justify-center gap-3 sm:gap-6 pt-8 pb-4">
            <!-- 2ìœ„ -->
            <div class="flex flex-col items-center">
                <div
                    class="w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-gradient-to-tr from-gray-300 to-gray-100 flex items-center justify-center text-2xl font-black text-gray-700 ring-4 ring-gray-200 dark:ring-gray-600 shadow-lg">
                    ê¹€</div>
                <div class="mt-3 text-center">
                    <p class="text-xs sm:text-sm font-bold text-slate-900 dark:text-white">ê¹€ì¤€í˜¸</p>
                    <p class="text-[10px] text-text-muted">2,340 XP</p>
                </div>
                <div
                    class="mt-2 bg-gray-100 dark:bg-gray-800 rounded-t-xl w-20 sm:w-24 h-20 flex items-center justify-center text-2xl font-black text-gray-500">
                    2</div>
            </div>
            <!-- 1ìœ„ -->
            <div class="flex flex-col items-center -mt-4">
                <div class="text-3xl mb-1">ğŸ‘‘</div>
                <div
                    class="w-20 h-20 sm:w-24 sm:h-24 rounded-full bg-gradient-to-tr from-yellow-400 to-amber-500 flex items-center justify-center text-3xl font-black text-white ring-4 ring-yellow-300 shadow-xl">
                    ì´</div>
                <div class="mt-3 text-center">
                    <p class="text-sm sm:text-base font-black text-slate-900 dark:text-white">ì´ì„œì—°</p>
                    <p class="text-xs text-amber-600 dark:text-amber-400 font-bold">3,120 XP</p>
                </div>
                <div
                    class="mt-2 bg-gradient-to-t from-yellow-400 to-amber-500 rounded-t-xl w-24 sm:w-28 h-28 flex items-center justify-center text-3xl font-black text-white">
                    1</div>
            </div>
            <!-- 3ìœ„ -->
            <div class="flex flex-col items-center">
                <div
                    class="w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-gradient-to-tr from-amber-700 to-amber-600 flex items-center justify-center text-2xl font-black text-white ring-4 ring-amber-400/50 shadow-lg">
                    ë°•</div>
                <div class="mt-3 text-center">
                    <p class="text-xs sm:text-sm font-bold text-slate-900 dark:text-white">ë°•ë¯¼ì„œ</p>
                    <p class="text-[10px] text-text-muted">1,890 XP</p>
                </div>
                <div
                    class="mt-2 bg-amber-100 dark:bg-amber-900/30 rounded-t-xl w-20 sm:w-24 h-16 flex items-center justify-center text-2xl font-black text-amber-700 dark:text-amber-400">
                    3</div>
            </div>
        </div>

        <!-- ë­í‚¹ í…Œì´ë¸” -->
        <div
            class="bg-white dark:bg-surface-dark rounded-2xl border border-border-light dark:border-border-dark shadow-card overflow-hidden">
            <table class="w-full">
                <thead>
                    <tr class="border-b border-border-light dark:border-border-dark bg-gray-50 dark:bg-gray-800">
                        <th
                            class="text-left px-4 sm:px-6 py-3 text-[10px] font-bold text-text-muted uppercase tracking-wider">
                            ìˆœìœ„</th>
                        <th
                            class="text-left px-4 sm:px-6 py-3 text-[10px] font-bold text-text-muted uppercase tracking-wider">
                            í•™ìƒ</th>
                        <th
                            class="text-left px-4 sm:px-6 py-3 text-[10px] font-bold text-text-muted uppercase tracking-wider hidden sm:table-cell">
                            ë ˆë²¨</th>
                        <th
                            class="text-left px-4 sm:px-6 py-3 text-[10px] font-bold text-text-muted uppercase tracking-wider hidden sm:table-cell">
                            í•´ê²° ë¬¸ì œ</th>
                        <th
                            class="text-right px-4 sm:px-6 py-3 text-[10px] font-bold text-text-muted uppercase tracking-wider">
                            XP</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-border-light dark:divide-border-dark">
                    <tr class="bg-yellow-50/50 dark:bg-yellow-900/5">
                        <td class="px-4 sm:px-6 py-3 text-sm font-bold text-amber-600">ğŸ¥‡</td>
                        <td class="px-4 sm:px-6 py-3">
                            <div class="flex items-center gap-2">
                                <div
                                    class="w-7 h-7 rounded-full bg-gradient-to-tr from-yellow-400 to-amber-500 flex items-center justify-center text-white text-xs font-bold">
                                    ì´</div><span class="text-sm font-bold text-slate-900 dark:text-white">ì´ì„œì—°</span>
                            </div>
                        </td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-text-muted hidden sm:table-cell">Lv.8</td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-text-muted hidden sm:table-cell">68</td>
                        <td class="px-4 sm:px-6 py-3 text-sm font-bold text-amber-600 text-right">3,120</td>
                    </tr>
                    <tr>
                        <td class="px-4 sm:px-6 py-3 text-sm font-bold text-gray-500">ğŸ¥ˆ</td>
                        <td class="px-4 sm:px-6 py-3">
                            <div class="flex items-center gap-2">
                                <div
                                    class="w-7 h-7 rounded-full bg-gradient-to-tr from-gray-300 to-gray-100 flex items-center justify-center text-gray-700 text-xs font-bold">
                                    ê¹€</div><span class="text-sm font-bold text-slate-900 dark:text-white">ê¹€ì¤€í˜¸</span>
                            </div>
                        </td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-text-muted hidden sm:table-cell">Lv.7</td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-text-muted hidden sm:table-cell">52</td>
                        <td class="px-4 sm:px-6 py-3 text-sm font-bold text-gray-500 text-right">2,340</td>
                    </tr>
                    <tr>
                        <td class="px-4 sm:px-6 py-3 text-sm font-bold text-amber-700">ğŸ¥‰</td>
                        <td class="px-4 sm:px-6 py-3">
                            <div class="flex items-center gap-2">
                                <div
                                    class="w-7 h-7 rounded-full bg-gradient-to-tr from-amber-700 to-amber-600 flex items-center justify-center text-white text-xs font-bold">
                                    ë°•</div><span class="text-sm font-bold text-slate-900 dark:text-white">ë°•ë¯¼ì„œ</span>
                            </div>
                        </td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-text-muted hidden sm:table-cell">Lv.6</td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-text-muted hidden sm:table-cell">45</td>
                        <td class="px-4 sm:px-6 py-3 text-sm font-bold text-amber-700 text-right">1,890</td>
                    </tr>
                    <tr class="bg-primary/5 dark:bg-primary/10">
                        <td class="px-4 sm:px-6 py-3 text-sm font-bold text-primary">4</td>
                        <td class="px-4 sm:px-6 py-3">
                            <div class="flex items-center gap-2">
                                <div
                                    class="w-7 h-7 rounded-full bg-primary flex items-center justify-center text-white text-xs font-bold">
                                    ë‚˜</div><span class="text-sm font-bold text-primary">ë‚˜ (ë‚˜)</span>
                            </div>
                        </td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-primary hidden sm:table-cell">Lv.5</td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-primary hidden sm:table-cell">38</td>
                        <td class="px-4 sm:px-6 py-3 text-sm font-bold text-primary text-right">1,560</td>
                    </tr>
                    <tr>
                        <td class="px-4 sm:px-6 py-3 text-sm text-text-muted">5</td>
                        <td class="px-4 sm:px-6 py-3">
                            <div class="flex items-center gap-2">
                                <div
                                    class="w-7 h-7 rounded-full bg-rose-100 text-rose-600 flex items-center justify-center text-xs font-bold">
                                    ì •</div><span class="text-sm font-bold text-slate-900 dark:text-white">ì •í•˜ìœ¤</span>
                            </div>
                        </td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-text-muted hidden sm:table-cell">Lv.5</td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-text-muted hidden sm:table-cell">34</td>
                        <td class="px-4 sm:px-6 py-3 text-sm font-bold text-text-muted text-right">1,420</td>
                    </tr>
                    <tr>
                        <td class="px-4 sm:px-6 py-3 text-sm text-text-muted">6</td>
                        <td class="px-4 sm:px-6 py-3">
                            <div class="flex items-center gap-2">
                                <div
                                    class="w-7 h-7 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-xs font-bold">
                                    ìµœ</div><span class="text-sm font-bold text-slate-900 dark:text-white">ìµœë„ìœ¤</span>
                            </div>
                        </td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-text-muted hidden sm:table-cell">Lv.4</td>
                        <td class="px-4 sm:px-6 py-3 text-xs text-text-muted hidden sm:table-cell">28</td>
                        <td class="px-4 sm:px-6 py-3 text-sm font-bold text-text-muted text-right">1,100</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>

    <script>
        function setTab(el, t) { document.querySelectorAll('.tab-btn').forEach(b => { b.classList.remove('active'); b.classList.add('border', 'border-gray-200', 'dark:border-gray-700') }); el.classList.add('active'); el.classList.remove('border', 'border-gray-200', 'dark:border-gray-700') }
        function toggleDark() { document.documentElement.classList.toggle('dark'); const d = document.documentElement.classList.contains('dark'); localStorage.setItem('elite-dark', d ? '1' : '0'); document.querySelector('.dark-icon').classList.toggle('hidden', d); document.querySelector('.light-icon').classList.toggle('hidden', !d) }
        (function () { if (localStorage.getItem('elite-dark') === '1') { document.documentElement.classList.add('dark'); document.querySelector('.dark-icon')?.classList.add('hidden'); document.querySelector('.light-icon')?.classList.remove('hidden') } })();

        // === Supabase ì—°ë™ ===
        const SUPABASE_URL = 'https://mkihwheknuioouccevet.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1raWh3aGVrbnVpb291Y2NldmV0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEwMzQzMDAsImV4cCI6MjA4NjYxMDMwMH0.0X7Zn97Q9jUzNo3FdA4IMDdYhpMDNYW4K_mGBKCjw88';
        let supabase = null;
        let currentUser = null;

        // postMessageë¡œ ë¶€ëª¨ í”„ë ˆì„ì—ì„œ ì¸ì¦ í† í° ìˆ˜ì‹ 
        window.addEventListener('message', async (e) => {
            if (e.data && e.data.type === 'elite-auth') {
                try {
                    supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
                        global: { headers: { Authorization: 'Bearer ' + e.data.token } }
                    });
                    currentUser = e.data.user || null;
                    await loadLeaderboard();
                } catch (err) { console.warn('Supabase auth failed:', err); }
            }
        });

        // Supabaseì—ì„œ ë¦¬ë”ë³´ë“œ ë°ì´í„° ë¡œë“œ
        async function loadLeaderboard() {
            if (!supabase) return;
            try {
                const { data, error } = await supabase
                    .from('learning_progress')
                    .select('user_id, display_name, xp, level, problems_solved')
                    .order('xp', { ascending: false })
                    .limit(10);
                if (error) throw error;
                if (data && data.length > 0) {
                    renderLeaderboard(data);
                }
            } catch (err) {
                console.warn('ë¦¬ë”ë³´ë“œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨, ëª©ì—… ìœ ì§€:', err.message);
            }
        }

        function renderLeaderboard(users) {
            const tbody = document.querySelector('tbody');
            if (!tbody || users.length < 1) return;
            const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];
            const gradients = [
                'from-yellow-400 to-amber-500',
                'from-gray-300 to-gray-100',
                'from-amber-700 to-amber-600'
            ];
            tbody.innerHTML = users.map((u, i) => {
                const isMe = currentUser && u.user_id === currentUser.id;
                const rank = i < 3 ? medals[i] : (i + 1);
                const initial = (u.display_name || '?')[0];
                const bgClass = i === 0 ? 'bg-yellow-50/50 dark:bg-yellow-900/5' : (isMe ? 'bg-primary/5 dark:bg-primary/10' : '');
                const textClass = isMe ? 'text-primary' : (i < 3 ? ['text-amber-600', 'text-gray-500', 'text-amber-700'][i] : 'text-text-muted');
                const avatarBg = i < 3 ? `bg-gradient-to-tr ${gradients[i]}` : (isMe ? 'bg-primary' : 'bg-indigo-100 text-indigo-600');
                const avatarText = i < 3 ? (i === 1 ? 'text-gray-700' : 'text-white') : (isMe ? 'text-white' : '');
                return `<tr class="${bgClass}"><td class="px-4 sm:px-6 py-3 text-sm font-bold ${textClass}">${rank}</td><td class="px-4 sm:px-6 py-3"><div class="flex items-center gap-2"><div class="w-7 h-7 rounded-full ${avatarBg} ${avatarText} flex items-center justify-center text-xs font-bold">${initial}</div><span class="text-sm font-bold ${isMe ? 'text-primary' : 'text-slate-900 dark:text-white'}">${u.display_name}${isMe ? ' (ë‚˜)' : ''}</span></div></td><td class="px-4 sm:px-6 py-3 text-xs ${isMe ? 'text-primary' : 'text-text-muted'} hidden sm:table-cell">Lv.${u.level || 1}</td><td class="px-4 sm:px-6 py-3 text-xs ${isMe ? 'text-primary' : 'text-text-muted'} hidden sm:table-cell">${u.problems_solved || 0}</td><td class="px-4 sm:px-6 py-3 text-sm font-bold ${textClass} text-right">${(u.xp || 0).toLocaleString()}</td></tr>`;
            }).join('');
        }

        // ì´ˆê¸°í™”: Supabase ì§ì ‘ ì—°ê²° ì‹œë„ (iframe ì™¸ë¶€ ì ‘ê·¼ ì‹œ)
        (async function initSupabase() {
            try {
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                const { data: { user } } = await supabase.auth.getUser();
                if (user) { currentUser = user; await loadLeaderboard(); }
            } catch (e) { /* ëª©ì—… ë°ì´í„° ìœ ì§€ */ }
        })();
    </script>
</body>

</html>