<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>ë‚´ í”„ë¡œí•„ â€” ì½”ë”©ì™ Elite</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <script>tailwind.config = { darkMode: "class", theme: { extend: { colors: { primary: "#2563eb", "primary-dark": "#1d4ed8", "text-main": "#1e293b", "text-muted": "#64748b", "bg-off": "#f8fafc", "bg-dark": "#0f172a", "surface-dark": "#1e293b", "border-light": "#e2e8f0", "border-dark": "#334155" }, fontFamily: { sans: ["Inter", "sans-serif"] }, boxShadow: { soft: "0 4px 20px -2px rgba(37,99,235,0.15)", card: "0 2px 10px rgba(0,0,0,0.03)" } } } }</script>
    <style>
        .nav-item.active {
            background: rgba(37, 99, 235, .1);
            color: #2563eb;
            border-color: #2563eb
        }

        .dark .nav-item.active {
            background: rgba(37, 99, 235, .2);
            color: #93c5fd
        }

        .heatmap-cell {
            width: 12px;
            height: 12px;
            border-radius: 2px
        }
    </style>
</head>

<body class="bg-bg-off dark:bg-bg-dark text-text-main dark:text-gray-100 font-sans antialiased min-h-screen">
    <!-- ê³µí†µ ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav
        class="sticky top-0 z-50 bg-white/90 dark:bg-surface-dark/90 backdrop-blur-md border-b border-border-light dark:border-border-dark">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 flex items-center justify-between h-14">
            <div class="flex items-center gap-3">
                <div
                    class="w-8 h-8 rounded-lg bg-primary flex items-center justify-center text-white shadow-md shadow-primary/30">
                    <span class="material-symbols-outlined text-lg">school</span>
                </div><span class="text-sm font-bold text-slate-900 dark:text-white">ì½”ë”©ì™ <span
                        class="text-primary">Elite</span></span>
            </div>
            <div class="hidden md:flex items-center gap-1">
                <a href="roadmap.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ—ºï¸
                    ë¡œë“œë§µ</a>
                <a href="hub.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ“š
                    í—ˆë¸Œ</a>
                <a href="challenge.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ¯
                    ì±Œë¦°ì§€</a>
                <a href="leaderboard.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ†
                    ë¦¬ë”ë³´ë“œ</a>
                <a href="goals.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ¯
                    ëª©í‘œ</a>
                <a href="profile.html"
                    class="nav-item active flex items-center gap-1.5 px-3 py-1.5 text-xs font-bold rounded-lg border-b-2 transition-all">ğŸ‘¤
                    í”„ë¡œí•„</a>
                <a href="editor.html"
                    class="nav-item flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-text-muted dark:text-gray-400 rounded-lg border-b-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">ğŸ’»
                    ì—ë””í„°</a>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="toggleDark()"
                    class="w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"><span
                        class="material-symbols-outlined text-lg dark-icon">dark_mode</span><span
                        class="material-symbols-outlined text-lg light-icon hidden">light_mode</span></button>
                <button onclick="document.getElementById('mmenu').classList.toggle('hidden')"
                    class="md:hidden w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-800 flex items-center justify-center"><span
                        class="material-symbols-outlined text-lg text-gray-500">menu</span></button>
            </div>
        </div>
        <div id="mmenu"
            class="hidden md:hidden border-t border-border-light dark:border-border-dark bg-white dark:bg-surface-dark px-4 py-2 space-y-1">
            <a href="roadmap.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ—ºï¸ ë¡œë“œë§µ</a><a
                href="hub.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ“š í—ˆë¸Œ</a><a
                href="challenge.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ¯ ì±Œë¦°ì§€</a><a
                href="leaderboard.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ† ë¦¬ë”ë³´ë“œ</a><a
                href="goals.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ¯ ëª©í‘œ</a>
            <a href="profile.html" class="block px-3 py-2 text-sm font-bold text-primary bg-primary/10 rounded-lg">ğŸ‘¤
                í”„ë¡œí•„</a>
            <a href="editor.html" class="block px-3 py-2 text-sm text-text-muted rounded-lg">ğŸ’» ì—ë””í„°</a>
        </div>
    </nav>

    <main class="max-w-4xl mx-auto px-4 sm:px-6 py-8 space-y-8">
        <!-- í”„ë¡œí•„ í—¤ë” -->
        <div
            class="bg-gradient-to-r from-primary via-blue-600 to-indigo-700 rounded-2xl p-6 sm:p-8 text-white relative overflow-hidden shadow-soft">
            <div class="absolute top-0 right-0 w-72 h-72 bg-white/5 rounded-full -translate-y-1/2 translate-x-1/3">
            </div>
            <div class="relative z-10 flex flex-col sm:flex-row items-center gap-6">
                <div
                    class="w-24 h-24 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center text-4xl font-black ring-4 ring-white/30 shadow-xl">
                    ğŸ§‘â€ğŸ’»</div>
                <div class="text-center sm:text-left">
                    <h1 class="text-2xl font-black mb-1">ì½”ë”©ì™ í•™ìƒ</h1>
                    <p class="text-blue-200 text-sm mb-3">ì´ˆë“± 5í•™ë…„ â€¢ ì½”ë”©ì™ ì•„ì¹´ë°ë¯¸</p>
                    <div class="flex flex-wrap justify-center sm:justify-start gap-2">
                        <span class="bg-white/15 backdrop-blur-sm px-3 py-1 rounded-lg text-xs font-bold">âš¡ 1,560
                            XP</span>
                        <span class="bg-white/15 backdrop-blur-sm px-3 py-1 rounded-lg text-xs font-bold">ğŸ“Š ë ˆë²¨ 5</span>
                        <span class="bg-white/15 backdrop-blur-sm px-3 py-1 rounded-lg text-xs font-bold">ğŸ”¥ 7ì¼
                            ì—°ì†</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ë ˆë²¨ ì§„í–‰ -->
        <div
            class="bg-white dark:bg-surface-dark rounded-2xl border border-border-light dark:border-border-dark p-6 shadow-card">
            <div class="flex items-center justify-between mb-3">
                <h2 class="text-sm font-bold text-slate-900 dark:text-white flex items-center gap-2"><span
                        class="material-symbols-outlined text-primary text-lg">upgrade</span> ë ˆë²¨ ì§„í–‰</h2>
                <span class="text-xs font-bold text-primary">Lv.5 â†’ Lv.6</span>
            </div>
            <div class="w-full h-4 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden">
                <div class="h-full bg-gradient-to-r from-primary to-indigo-500 rounded-full w-[72%] relative">
                    <div class="absolute inset-0 bg-white/20 animate-pulse rounded-full"></div>
                </div>
            </div>
            <div class="flex justify-between mt-2 text-xs text-text-muted"><span>1,560 / 2,000 XP</span><span>440 XP
                    ë‚¨ìŒ</span></div>
        </div>

        <!-- ë±ƒì§€ -->
        <section>
            <h2 class="text-lg font-bold text-slate-900 dark:text-white mb-5 flex items-center gap-2"><span
                    class="material-symbols-outlined text-amber-500">military_tech</span> íšë“ ë±ƒì§€</h2>
            <div class="grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-6 gap-3">
                <div
                    class="bg-white dark:bg-surface-dark rounded-2xl border border-border-light dark:border-border-dark p-4 shadow-card text-center hover:shadow-soft transition-all cursor-pointer group">
                    <div class="text-3xl mb-2 group-hover:scale-110 transition-transform">ğŸŒ±</div>
                    <p class="text-[10px] font-bold text-slate-900 dark:text-white">ì²« ê±¸ìŒ</p>
                    <p class="text-[8px] text-text-muted">ì²« ë¬¸ì œ í•´ê²°</p>
                </div>
                <div
                    class="bg-white dark:bg-surface-dark rounded-2xl border border-border-light dark:border-border-dark p-4 shadow-card text-center hover:shadow-soft transition-all cursor-pointer group">
                    <div class="text-3xl mb-2 group-hover:scale-110 transition-transform">ğŸ”¥</div>
                    <p class="text-[10px] font-bold text-slate-900 dark:text-white">ë¶ˆê½ƒ í•™ìŠµ</p>
                    <p class="text-[8px] text-text-muted">7ì¼ ì—°ì†</p>
                </div>
                <div
                    class="bg-white dark:bg-surface-dark rounded-2xl border border-border-light dark:border-border-dark p-4 shadow-card text-center hover:shadow-soft transition-all cursor-pointer group">
                    <div class="text-3xl mb-2 group-hover:scale-110 transition-transform">ğŸ’¯</div>
                    <p class="text-[10px] font-bold text-slate-900 dark:text-white">ì™„ë²½ì£¼ì˜</p>
                    <p class="text-[8px] text-text-muted">ë§Œì  ë‹¬ì„±</p>
                </div>
                <div
                    class="bg-white dark:bg-surface-dark rounded-2xl border border-border-light dark:border-border-dark p-4 shadow-card text-center hover:shadow-soft transition-all cursor-pointer group">
                    <div class="text-3xl mb-2 group-hover:scale-110 transition-transform">ğŸ›</div>
                    <p class="text-[10px] font-bold text-slate-900 dark:text-white">ë²„ê·¸ í—Œí„°</p>
                    <p class="text-[8px] text-text-muted">10ê°œ ë””ë²„ê¹…</p>
                </div>
                <div
                    class="bg-white dark:bg-surface-dark rounded-2xl border border-border-light dark:border-border-dark p-4 shadow-card text-center hover:shadow-soft transition-all cursor-pointer group">
                    <div class="text-3xl mb-2 group-hover:scale-110 transition-transform">ğŸ§ </div>
                    <p class="text-[10px] font-bold text-slate-900 dark:text-white">ì•Œê³ ë¦¬ì¦˜</p>
                    <p class="text-[8px] text-text-muted">ì •ë ¬ ë§ˆìŠ¤í„°</p>
                </div>
                <div
                    class="bg-white dark:bg-surface-dark rounded-2xl border border-border-light dark:border-border-dark p-4 shadow-card text-center opacity-40">
                    <div class="text-3xl mb-2">ğŸ”’</div>
                    <p class="text-[10px] font-bold text-text-muted">???</p>
                    <p class="text-[8px] text-text-muted">50ë¬¸ì œ í•´ê²°</p>
                </div>
            </div>
        </section>

        <!-- í™œë™ íˆíŠ¸ë§µ -->
        <section>
            <h2 class="text-lg font-bold text-slate-900 dark:text-white mb-5 flex items-center gap-2"><span
                    class="material-symbols-outlined text-emerald-500">calendar_month</span> í•™ìŠµ í™œë™</h2>
            <div
                class="bg-white dark:bg-surface-dark rounded-2xl border border-border-light dark:border-border-dark p-5 shadow-card overflow-x-auto">
                <div class="flex gap-1 min-w-[600px]" id="heatmap"></div>
                <div class="flex items-center justify-end gap-2 mt-3 text-[10px] text-text-muted">
                    <span>ì ìŒ</span>
                    <div class="heatmap-cell bg-gray-100 dark:bg-gray-700"></div>
                    <div class="heatmap-cell bg-emerald-200 dark:bg-emerald-800"></div>
                    <div class="heatmap-cell bg-emerald-400 dark:bg-emerald-600"></div>
                    <div class="heatmap-cell bg-emerald-600 dark:bg-emerald-400"></div>
                    <span>ë§ìŒ</span>
                </div>
            </div>
        </section>

        <!-- ìµœê·¼ í™œë™ -->
        <section>
            <h2 class="text-lg font-bold text-slate-900 dark:text-white mb-5 flex items-center gap-2"><span
                    class="material-symbols-outlined text-blue-500">history</span> ìµœê·¼ í™œë™</h2>
            <div class="space-y-3">
                <div
                    class="bg-white dark:bg-surface-dark rounded-xl border border-border-light dark:border-border-dark p-4 shadow-card flex items-center gap-3">
                    <div
                        class="w-9 h-9 rounded-lg bg-emerald-100 dark:bg-emerald-900/20 text-emerald-600 flex items-center justify-center">
                        <span class="material-symbols-outlined text-lg">check_circle</span>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm font-bold text-slate-900 dark:text-white">"ë³€ìˆ˜ì™€ ìë£Œí˜•" í€´ì¦ˆ ì™„ë£Œ</p>
                        <p class="text-[10px] text-text-muted">2ì‹œê°„ ì „ â€¢ +30 XP</p>
                    </div>
                </div>
                <div
                    class="bg-white dark:bg-surface-dark rounded-xl border border-border-light dark:border-border-dark p-4 shadow-card flex items-center gap-3">
                    <div
                        class="w-9 h-9 rounded-lg bg-amber-100 dark:bg-amber-900/20 text-amber-600 flex items-center justify-center">
                        <span class="material-symbols-outlined text-lg">emoji_events</span>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm font-bold text-slate-900 dark:text-white">"ë¶ˆê½ƒ í•™ìŠµ" ë±ƒì§€ íšë“</p>
                        <p class="text-[10px] text-text-muted">ì–´ì œ â€¢ +100 XP</p>
                    </div>
                </div>
                <div
                    class="bg-white dark:bg-surface-dark rounded-xl border border-border-light dark:border-border-dark p-4 shadow-card flex items-center gap-3">
                    <div
                        class="w-9 h-9 rounded-lg bg-blue-100 dark:bg-blue-900/20 text-blue-600 flex items-center justify-center">
                        <span class="material-symbols-outlined text-lg">code</span>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm font-bold text-slate-900 dark:text-white">ë°ì¼ë¦¬ ì±Œë¦°ì§€ "í”¼ë³´ë‚˜ì¹˜ ìˆ˜" í•´ê²°</p>
                        <p class="text-[10px] text-text-muted">2ì¼ ì „ â€¢ +50 XP</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
            // íˆíŠ¸ë§µ ìƒì„±
            (function () { const h = document.getElementById('heatmap'); const levels = ['bg-gray-100 dark:bg-gray-700', 'bg-emerald-200 dark:bg-emerald-800', 'bg-emerald-400 dark:bg-emerald-600', 'bg-emerald-600 dark:bg-emerald-400']; for (let w = 0; w < 20; w++) { const col = document.createElement('div'); col.className = 'flex flex-col gap-1'; for (let d = 0; d < 7; d++) { const cell = document.createElement('div'); cell.className = 'heatmap-cell ' + levels[Math.floor(Math.random() * 4)]; col.appendChild(cell) } h.appendChild(col) } })();
        function toggleDark() { document.documentElement.classList.toggle('dark'); const d = document.documentElement.classList.contains('dark'); localStorage.setItem('elite-dark', d ? '1' : '0'); document.querySelector('.dark-icon').classList.toggle('hidden', d); document.querySelector('.light-icon').classList.toggle('hidden', !d) }
        (function () { if (localStorage.getItem('elite-dark') === '1') { document.documentElement.classList.add('dark'); document.querySelector('.dark-icon')?.classList.add('hidden'); document.querySelector('.light-icon')?.classList.remove('hidden') } })();

        // === Supabase ì—°ë™ ===
        const SUPABASE_URL = 'https://mkihwheknuioouccevet.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1raWh3aGVrbnVpb291Y2NldmV0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEwMzQzMDAsImV4cCI6MjA4NjYxMDMwMH0.0X7Zn97Q9jUzNo3FdA4IMDdYhpMDNYW4K_mGBKCjw88';
        let sb = null;

        // postMessageë¡œ ë¶€ëª¨ í”„ë ˆì„ ì¸ì¦ í† í° ìˆ˜ì‹ 
        window.addEventListener('message', async (e) => {
            if (e.data && e.data.type === 'elite-auth') {
                try {
                    sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
                        global: { headers: { Authorization: 'Bearer ' + e.data.token } }
                    });
                    await loadProfile(e.data.user);
                } catch (err) { console.warn('Supabase auth failed:', err); }
            }
        });

        async function loadProfile(authUser) {
            if (!sb || !authUser) return;
            try {
                const { data, error } = await sb
                    .from('learning_progress')
                    .select('display_name, xp, level, problems_solved, streak_days, badges')
                    .eq('user_id', authUser.id)
                    .single();
                if (error) throw error;
                if (data) updateProfileUI(data, authUser);
            } catch (err) {
                console.warn('í”„ë¡œí•„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨, ëª©ì—… ìœ ì§€:', err.message);
            }
        }

        function updateProfileUI(p, authUser) {
            // ì´ë¦„ ì—…ë°ì´íŠ¸
            const nameEl = document.querySelector('h1.font-black');
            if (nameEl) nameEl.textContent = p.display_name || authUser.email?.split('@')[0] || 'ì½”ë”©ì™ í•™ìƒ';
            // XP, ë ˆë²¨, ìŠ¤íŠ¸ë¦­ ì—…ë°ì´íŠ¸
            const stats = document.querySelectorAll('.bg-white\\/15');
            if (stats[0]) stats[0].innerHTML = `âš¡ ${(p.xp || 0).toLocaleString()} XP`;
            if (stats[1]) stats[1].innerHTML = `ğŸ“Š ë ˆë²¨ ${p.level || 1}`;
            if (stats[2]) stats[2].innerHTML = `ğŸ”¥ ${p.streak_days || 0}ì¼ ì—°ì†`;
            // ë ˆë²¨ ì§„í–‰ ë°”
            const nextLevel = (p.level || 1) + 1;
            const nextXP = nextLevel * 400;
            const pct = Math.min(100, Math.round(((p.xp || 0) % 400) / 4));
            const lvlLabel = document.querySelector('.text-primary.text-xs.font-bold');
            if (lvlLabel) lvlLabel.textContent = `Lv.${p.level || 1} \u2192 Lv.${nextLevel}`;
            const bar = document.querySelector('.bg-gradient-to-r.from-primary.to-indigo-500');
            if (bar) bar.style.width = pct + '%';
            const xpText = document.querySelectorAll('.flex.justify-between.mt-2 span');
            if (xpText[0]) xpText[0].textContent = `${(p.xp || 0).toLocaleString()} / ${nextXP.toLocaleString()} XP`;
            if (xpText[1]) xpText[1].textContent = `${(nextXP - (p.xp || 0)).toLocaleString()} XP ë‚¨ìŒ`;
        }

        // ì´ˆê¸°í™”: ì§ì ‘ ì—°ê²° ì‹œë„
        (async function initSupabase() {
            try {
                sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                const { data: { user } } = await sb.auth.getUser();
                if (user) await loadProfile(user);
            } catch (e) { /* ëª©ì—… ìœ ì§€ */ }
        })();
    </script>
</body>

</html>